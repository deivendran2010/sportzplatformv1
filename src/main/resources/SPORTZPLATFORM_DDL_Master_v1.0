/*
drop table user_role;
drop table users;

drop table company_type_association;
drop table company;
drop table address;
drop table lookup_table;
drop table lookup_type;
*/

use sportzplatform_db;

/* 
	Table Name: lookup_type
    Purpose: Table to hold Lookup types
*/
Create Table lookup_type
(
	lookup_type char(3) not null,
    lookup_desc varchar(255) not null,
    PRIMARY KEY (lookup_type)
);

/* 
	Table Name: lookup_table
    Purpose: Table to hold Lookup values based on loojup types
*/
Create Table lookup_table
(
	lookup_key char(3) not null,
    lookup_value varchar(255) not null,
	lookup_type char(3) not null,
    PRIMARY KEY (lookup_type,lookup_key),
    CONSTRAINT FK_lookup_table_lookup_type FOREIGN KEY (lookup_type) REFERENCES lookup_type (lookup_type)
);

/* 
	Table Name: address
    Purpose: Table to hold address details
*/
Create table address
(
	address_id	int GENERATED BY DEFAULT AS IDENTITY,
	address_line1	varchar(255) not null,
	address_line2	varchar(255),
	address_line3	varchar(255),
	postal_code	varchar(10) not null,
	city	varchar(100) not null,
	state	char(3) not null,
	country	char(3) not null,
	latitude	varchar(10),
	longtitude	varchar(10),
    primary key (address_id)
);

/* 
	Table Name: company
    Purpose: Table to hold company details
*/
Create table company
(
	company_id int GENERATED BY DEFAULT AS IDENTITY,
    company_name	varchar(255) not null,
	company_specialization char(3) not null,
    address_ref_id	int,
	company_contact_person	varchar(255) not null,
	company_contact_no	varchar(50) not null,
	company_email	varchar(320) not null,
	company_website	varchar(500) not null,
    company_reg_no varchar(15) not null,
	company_status varchar(2) not null,
	company_timezone char(3) not null,
    company_base_currency char(3) not null,
    company_logo varchar(255) null,
    parent_company_id int null,
    calendar_timeslot char(3) not null,
    is_today_calendar_startdate char(3) not null default 'NO',
	created_by int not null,
	created_date timestamp not null,
	modified_by int,
	modified_date timestamp,
    primary key (company_id),
    constraint FK_company_address foreign key (address_ref_id) references address (address_id),
	constraint FK_company_company foreign key (parent_company_id) references company (company_id),
    unique(company_name)
);

/* 
	Table Name: company_type_association
    Purpose: Table to hold company type association
*/
create table company_type_association
(
	company_type_association_id int GENERATED BY DEFAULT AS IDENTITY,
    company_ref_id int not null,
    company_type char(3) not null,
	primary key (company_type_association_id),
    constraint FK_company_type_association_company foreign key (company_ref_id) references company (company_id),
	unique(company_ref_id,company_type)
);

/* 
	Table Name: users
    Purpose: Table to capture if users to the application
*/
Create table users
(
	user_id	int GENERATED BY DEFAULT AS IDENTITY,
    first_name	varchar(100) not null,
	last_name	varchar(100) not null,
	middle_name	varchar(100),
    user_email	varchar(320) not null,
	user_phone	varchar(50) not null,
    user_password	varchar(255) not null,
	company_ref_id	int not null,
	last_login_date	timestamp,
    profile_pic varchar(100),
    reset_token varchar(45) null ,
    user_status char(3) not null default 'AC',
    created_by int null,
	created_date timestamp not null,
	modified_by int,
	modified_date timestamp,
    primary key (user_id),
    unique(user_email),
    constraint FK_users_company foreign key (company_ref_id) references company (company_id)
);

/* 
	Table Name: user_role
    Purpose: Table to capture if users roles
*/
create table user_role
(
	user_role_id int GENERATED BY DEFAULT AS IDENTITY,
	user_ref_id	int not null,
	role_type char(3) not null,
    primary key (user_role_id),
	unique(user_ref_id, role_type),
    constraint FK_user_role_user foreign key (user_ref_id) references users (user_id)
);